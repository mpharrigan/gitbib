{# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/. #}

<!DOCTYPE html>
<html lang="en">
  <!-- This file is autogenerated! Don't edit it! -->
  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>{{ fn }} - Gitbib</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.4/css/bootstrap.min.css">
    <style>
      body {
        position: relative;
        color: #111;
      }
      p.card-text{
        margin-bottom: 0.5rem;
      }
      h6.card-subtitle{
        margin-bottom: 0.5rem;
      }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script>
        // 0 - all implicitly enabled
        // 1 - enabled
        // 2 - hidden
        var tags = {
        {% for tag in all_tags -%}
            '{{ tag }}': 0,
        {% endfor -%}
        };
        var all_tags = true;

        function tag_toggle(name) {
            if (all_tags) {
                for (var i in tags) {
                    tag_disable(i);
                    tags[i] = 2;
                }
                all_tags = false;
            }

            if (tags[name] === 1) {
                tag_disable(name);
                tags[name] = 2;
            } else if (tags[name] === 2) {
                tag_enable(name);
                tags[name] = 1;
            }
        }

        function tag_enable(name) {
            {% for tag in all_tags %}
                if (name === '{{ tag }}'){
                    {% for ident in idents_by_tag[tag] %}
                      $('#{{ ident | safe_css }}').show();
                    {% endfor %}
                    $('#{{ tag | safe_css }}').removeClass('tag-default').addClass('tag-primary')
                }
            {% endfor %}
        }

        function tag_disable(name) {
            {% for tag in all_tags %}
            if (name === '{{ tag }}'){
                {% for ident in idents_by_tag[tag] %}
                $('#{{ ident | safe_css }}').hide();
                {% endfor -%}
                $('#{{ tag | safe_css }}').removeClass('tag-primary').addClass('tag-default')
            }
            {% endfor %}
        }
    </script>

  </head>
  <body data-spy="scroll" data-target="#navlist">
    <div class="container">
      <div class="row" style="margin-top: 1rem;">
        <div class="col-xs-12 col-lg-9">
            <h5><a class="text-muted" href="{{user_info['index_url']}}">
                <i class="fa fa-home" aria-hidden="true"></i>
                {{user_info['slugname']}}
            </a> |
            All tags:
            {% for tag in all_tags %}
            <span class="tag tag-default" onclick="tag_toggle('{{tag}}')" id="{{tag}}">{{tag}}</span>
            {% endfor %}
            </h5>
            {% for entry in entries %}
            <div class="card">
              <div class="card-block" id="{{entry.ident | safe_css}}">
                <h4 class="card-title">{{entry['title']}}</h4>
                <h6 class="card-subtitle text-muted"><strong>{{entry.ident}}</strong></h6>
                <p class="card-text">{{entry['author'] | pretty_author_list }}</p>
                <p class="card-text">
                  {% if entry.published_online %}
                  {{entry.published_online}} (online)
                  {% endif %}
                  {% if entry.published_online and entry.published_print %}
                  &ndash;
                  {% endif %}
                  {% if entry.published_print %}
                  {{entry.published_print}} (print)
                  {% endif %}
                </p>
                <p class="card-text">
                  {% if entry.container_title %}<em>{{entry.container_title['full']}} ({{entry.container_title['short']}})</em>.{% endif %}
                  {% if entry.volume %}{{entry.volume}}, {% endif %}
                  {% if entry.issue %}{{entry.issue}}, {% endif %}
                  {% if entry.page %}{{entry.page}}. {% endif %}
                  {% if entry.url %}<a href="{{entry.url}}">{{entry.url}}</a>{% endif %}
                  {% if entry.doi %}<a href="https://dx.doi.org/{{entry.doi}}">doi:{{entry.doi}}</a>{% endif %}
                  {% if entry.arxiv %}<a href="https://arxiv.org/abs/{{entry.arxiv}}">arxiv:{{entry.arxiv}}</a>{% endif %}
                  {% if entry.pdf %}<a href="{{entry.pdf}}">[pdf]</a>{% endif %}
                </p>
                {% if entry.description %}
                <h6 class="m-b-0"><strong style="color: #444">Description</strong></h6>
                {{ entry.description | description }}
                {% endif %}

                {% if entry.pdb %}
                <h6 class="m-b-0"><strong style="color: #444">PDB codes</strong></h6>
                <p class="card-text">{{ entry.pdb | list_of_pdbs }}</p>
                {% endif %}

                {% if entry.cites %}
                    <a data-toggle="collapse" href="#{{entry.ident | safe_css}}-cites"
                       aria-expanded="false" aria-controls="{{entry.ident | safe_css}}-cites">
                    Show References
                    </a>
                    <table class="table table-sm collapse" id="{{entry.ident | safe_css}}-cites">
                    <tr>
                    <th>Num</th><th>Entry</th><th>Why</th>
                    </tr>
                    {% for cite in entry.cites %}
                        {% if cite.num %}
                        <tr>
                        <td>{{ cite.num }}</td>
                        <td><a href="#{{ cite.target_ident.ident | safe_css }}">{{ cite.target_ident.ident }}</a></td>
                        {% else %}
                        <td>{{ cite.target_ident.ident }}</td>
                        {% endif %}
                        <td>{{ cite.why }}</td>
                        </tr>
                    {% endfor %}
                    </table>
                {% endif %}

                {% if entry.tags %}
                <p class="card-text">
                  {% for tag in entry.tags %}
                  <span class="tag tag-primary">{{tag}}</span>
                  {% endfor %}
                </p>
                {% endif %}
              </div>
            </div>
            {% endfor %}
        </div>
        <div class="col-xs-12 col-lg-3">
          <h4>Items</h4>
          <div id="navlist">
            <ul class="nav">
              {% for entry in entries %}
              <li class="nav-item">
                <a class="nav-link" href="#{{entry.ident | safe_css}}">{{entry.ident}}</a>
              </li>
            {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.2.0/js/tether.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.4/js/bootstrap.min.js"></script>
    <script src="https://use.fontawesome.com/f678e12fb6.js"></script>
    <script>$('body').scrollspy({target: '#navlist'})</script>
  </body>
</html>